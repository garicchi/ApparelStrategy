rule,action
//initialize
{init}=[],{init}=[ok]&{j_st}=[0]&{status}=[wait]&{key1}=[0]&{key2}=[0]&{qr_data}=[null]&{s_u}=[]
//start
{u_u}=[.*試着.*]&{status}=[wait],{s_u}=[ポイントカードを見せてね]&{status}=[point_scan]&{s_u}=[picture]
{qr_data}![null]&{status}=[point_scan],{scan_point}=[{qr_data}]&{s_u}=[{current_user}さん、こんにちは。次に服を見せてね]&{status}=[cloth_scan]&{s_u}=[picture]
{qr_data}![null]&{status}=[cloth_scan],{scan_cloth}=[{qr_data}]&{s_u}=[{current_cloth}円だよ。まだ試着する服残ってる?]&{status}=[cloth_ask]
{u_u}=[.*ある.*]&{status}=[cloth_ask],{s_u}=[服を見せて]&{status}=[cloth_scan]&{s_u}=[picture]
{u_u}=[.*ない.*|.*無い.*|.*内容.*]&{status}=[cloth_ask],{end_cloth}=[]&{status}=[go_fit]&{s_u}=[ありがとう。試着室へどうぞ。試着が終わったら声をかけてね]
//go fitting room
{status}=[q1|go_fit]&{u_u}=[.*着た.*|.*きた.*|.*終わった.*|.*おわ.*],{status}=[q2]&{s_u}=[服の提案をしてもいいかな？]
{u_u}=![(.*はい.*|.*いいよ.*|.*おっけー.*|.*うん.*|.*提案.*|.*お願い.*|.*して.*|.*いや.*|.*やだ.*|.*駄目.*|.*大丈夫.*|.*嫌.*|.*しないで.*)]&{status}=[q2],{s_u}=[ごめん、言葉が難しくて分からなかった！服の提案をしてもいいかな？]
{u_u}=[(.*はい.*|.*いいよ.*|.*おっけー.*|.*うん.*|.*提案.*|.*お願い.*|.*して.*)]&{status}=[q2],{status}=[q3]&{s_u}=[ありがとう！いくつか質問させてね！どういうところに来て行く為の服が欲しいの？]
{u_u}=[(.*いや.*|.*やだ.*|.*駄目.*|.*大丈夫.*|.*嫌.*|.*しないで.*)]&{status}=[q2],{status}=[qz]&{s_u}=[分かったよ！今日は来てくれてどうもありがとう！気をつけて帰ってね]
{u_u}=![(.*祭.*|.*パーティ.*|.*プール.*|.*ない.*)]&{status}=[q3],{s_u}=[ごめんね、その場所は登録されてないみたい！他の場所は無いかな？]
{u_u}=[.*祭.*]&{status}=[q3],｛key1｝=[祭]&{status}={q4}&{s_u}=[そっかお祭りだね！もう少し質問させてね、どういう時期の服が欲しいの？]
{u_u}=[.*パーティ.*]&{status}=[q3],｛key1｝=[パーティー]&{status}={q4}&{s_u}=[そっかパーティーだね！もう少し質問させてね、どういう時期の服が欲しいの？]
{u_u}=[.*プール.*]&{status}=[q3],｛key1｝=[プール]&{status}={q4}&{s_u}=[そっかプールだね！もう少し質問させてね、どういう時期の服が欲しいの？]
{u_u}=[.*ない.*]&{status}=[q3],｛key1｝=[null]&{status}={q4}&{s_u}=[そっか特に決めてないんだね！もう少し質問させてね、どういう時期の服が欲しいの？]
{u_u}=![.*春.*|.*夏.*|.*秋.*|.*冬.*|.*ない.*]&{status}=[q4],{s_u}=[ごめんね、その時期は登録されて無いみたい！他の時期を教えてね！]
{u_u}=[.*春.*]&{status}=[q4],｛key2｝=[春]&{status}={q5}&{s_u}=[そっか春だね！今お勧めの服を探すね！]
{u_u}=[.*夏.*]&{status}=[q4],｛key2｝=[夏]&{status}={q5}&{s_u}=[そっか夏だね！今お勧めの服を探すね！]
{u_u}=[.*秋.*]&{status}=[q4],｛key2｝=[秋]&{status}={q5}&{s_u}=[そっか秋だね！今お勧めの服を探すね！]
{u_u}=[.*冬.*]&{status}=[q4],｛key2｝=[冬]&{status}={q5}&{s_u}=[そっか冬だね！今お勧めの服を探すね！]
{u_u}=[.*ない.*]&{status}=[q4],｛key2｝=[null]&{status}={q5}&{s_u}=[そっか特に決めてないんだね！今お勧めの服を探すね！]
{u_u}=[.*店員.*呼.*],{status_ren}=[{status}]&{status}=[qa]&{s_u}=[店員さんを呼びますか？]
{u_u}=![(.*はい.*|.*いいよ.*|.*おっけー.*|.*うん.*|.*提案.*|.*お願い.*|.*して.*|.*いや.*|.*やだ.*|.*駄目.*|.*大丈夫.*|.*嫌.*|.*しないで.*)]&{status}=[qa],{s_u}=[ごめん、言葉が難しくて分からなかった！もう少し簡単な言葉で言ってもらってもいいかな？店員さん呼ぶ？]
{u_u}=[(.*はい.*|.*いいよ.*|.*おっけー.*|.*うん.*|.*提案.*|.*お願い.*|.*して.*)]&{status}=[qa],{status}=[qz]&{s_u}=[わかったよ！店員さんを呼ぶからちょっと待っててねー！]
{u_u}=[(.*いや.*|.*やだ.*|.*駄目.*|.*大丈夫.*|.*嫌.*|.*しないで.*)]&{status}=[qa],{status}=[{status_ren}]&{s_u}=[分かったよ！会話に戻るね！]
{status}=[qz],{s_u}=[終わり]